<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/Escrow.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> Escrow.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">61.9% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>65/105</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">43.24% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>32/74</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">77.27% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>17/22</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">61.82% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>68/110</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity 0.4.24;
import "./HMTokenInterface.sol";
import "./helpers/SafeMath.sol";
&nbsp;
// An agentless escrow contract
contract Escrow {
    using SafeMath for uint256;
    event IntermediateStorage(string _url, string _hash);
    enum EscrowStatuses { Launched, Pending, Partial, Paid, Complete, Cancelled }
    EscrowStatuses private status;
&nbsp;
    address private reputationOracle;
    address private recordingOracle;
&nbsp;
    uint256 private reputationOracleStake;
    uint256 private recordingOracleStake;
&nbsp;
    address private canceler;
    address private eip20;
&nbsp;
    string private manifestUrl;
    string private manifestHash;
&nbsp;
    string private intermediateManifestUrl;
    string private intermediateManifestHash;
&nbsp;
    string private resultsManifestUrl;
    string private resultsManifestHash;
&nbsp;
    uint private expiration;
&nbsp;
    uint256[] private finalAmounts;
&nbsp;
    constructor(address _eip20, address _canceler, uint _expiration) public {
        eip20 = _eip20;
        canceler = _canceler;
        status = EscrowStatuses.Launched;
        expiration = _expiration.add(block.timestamp); // solhint-disable-line not-rely-on-time
    }
&nbsp;
    function getStatus() public view returns (EscrowStatuses) {
        return status;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getTokenAddress() public view returns (address</span>) {
<span class="cstat-no" title="statement not covered" >        return eip20;</span>
    }
&nbsp;
    function getBalance() public view returns (uint256) {
        return HMTokenInterface(eip20).balanceOf(address(this));
    }
&nbsp;
    function getAddressBalance(address _address) public view returns (uint256) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_address != address(0), "Token spender is an uninitialized address");
        return HMTokenInterface(eip20).balanceOf(address(_address));
    }
&nbsp;
    function getReputationOracle() public view returns (address) {
        return reputationOracle;
    }
&nbsp;
    function getRecordingOracle() public view returns (address) {
        return recordingOracle;
    }
&nbsp;
    function getHash() public view returns (string) {
        return manifestHash;
    }
&nbsp;
    function getUrl() public view returns (string) {
        return manifestUrl;
    }
&nbsp;
    function getIUrl() public view returns (string) {
        return intermediateManifestUrl;
    }
&nbsp;
    function getIHash() public view returns (string) {
        return intermediateManifestHash;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getFUrl() public view returns (string</span>) {
<span class="cstat-no" title="statement not covered" >        return resultsManifestUrl;</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getFHash() public view returns (string</span>) {
<span class="cstat-no" title="statement not covered" >        return resultsManifestHash;</span>
    }
&nbsp;
    // The escrower puts the Token in the contract without an agentless
    // and assigsn a reputation oracle to payout the bounty of size of the
    // amount specified
    function setup(
        address _reputationOracle,
        address _recordingOracle,
        uint256 _reputationOracleStake,
        uint256 _recordingOracleStake,
        uint256 _amount,
        string _url,
        string _hash
    ) public
    {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(expiration &gt; block.timestamp, "Contract expired");  // solhint-disable-line not-rely-on-time
        require(msg.sender == canceler, "Address calling not the canceler");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_reputationOracle != address(0), "Token spender is an uninitialized address");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_recordingOracle != address(0), "Token spender is an uninitialized address");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            _reputationOracleStake.add(_recordingOracleStake) &gt;= 0 &amp;&amp;
            _reputationOracleStake.add(_recordingOracleStake) &lt;= 100,
            "Stake out of bounds"
        );
        require(getBalance() &gt;= _amount, "Amount too high");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status == EscrowStatuses.Launched, "Escrow not in Launched status state");
&nbsp;
        reputationOracle = _reputationOracle;
        recordingOracle = _recordingOracle;
        reputationOracleStake = _reputationOracleStake;
        recordingOracleStake = _recordingOracleStake;
&nbsp;
        manifestUrl = _url;
        manifestHash = _hash;
        status = EscrowStatuses.Pending;
        emit Pending(manifestUrl, manifestHash);
    }
&nbsp;
    function abort()  public {
        require(msg.sender == canceler, "Address calling not the canceler");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status != EscrowStatuses.Partial, "Escrow in Partial status state");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status != EscrowStatuses.Complete, "Escrow in Complete status state");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status != EscrowStatuses.Paid, "Escrow in Paid status state");
        killContract();
    }
&nbsp;
    function complete() public returns (bool success) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(expiration &gt; block.timestamp, "Contract expired");  // solhint-disable-line not-rely-on-time
        <span class="missing-if-branch" title="if path not taken" >I</span>require(msg.sender == reputationOracle, "Address calling not the reputation oracle");
<span class="cstat-no" title="statement not covered" >        if (status == EscrowStatuses.Complete) {</span>
<span class="cstat-no" title="statement not covered" >            return true;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (status == EscrowStatuses.Paid) {</span>
<span class="cstat-no" title="statement not covered" >            status = EscrowStatuses.Complete</span>;
<span class="cstat-no" title="statement not covered" >            return true;</span>
        }
<span class="cstat-no" title="statement not covered" >        return false;</span>
    }
&nbsp;
    function storeResults(string _url, string _hash) public {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(expiration &gt; block.timestamp, "Contract expired");  // solhint-disable-line not-rely-on-time
        require(msg.sender == recordingOracle, "Address calling not the recording oracle");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            status == EscrowStatuses.Pending ||
            status == EscrowStatuses.Partial,
            "Escrow not in Pending or Partial status state"
        );
        intermediateManifestUrl = _url;
        intermediateManifestHash = _hash;
        emit IntermediateStorage(_url, _hash);
    }
&nbsp;
    function payOut(
        uint256 _amount,
        address _recipient,
        string _url,
        string _hash
    ) public returns (bool)
    {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(expiration &gt; block.timestamp, "Contract expired");  // solhint-disable-line not-rely-on-time
        require(msg.sender == reputationOracle, "Address calling not the reputation oracle");
        uint256 balance = getBalance();
        require(balance &gt; 0, "EIP20 contract out of funds");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(balance &gt;= _amount, "Amount too high");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status != EscrowStatuses.Launched, "Escrow in Launched status state");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(status != EscrowStatuses.Paid, "Escrow in Paid status state");
        resultsManifestUrl = _url;
        resultsManifestHash = _hash;
&nbsp;
        bool success = partialPayout(_amount, _recipient);
        balance = getBalance();
        <span class="missing-if-branch" title="else path not taken" >E</span>if (success) {
            <span class="missing-if-branch" title="else path not taken" >E</span>if (status == EscrowStatuses.Pending) {
                status = EscrowStatuses.Partial;
            }
            <span class="missing-if-branch" title="if path not taken" >I</span>if (balance == 0 &amp;&amp; status != EscrowStatuses.Paid) {
<span class="cstat-no" title="statement not covered" >                status = EscrowStatuses.Paid</span>;
            }
        }
        return success;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function bulkPayOut(</span>
        address[] _recipients,
        uint256[] _amounts,
        string _url,
        string _hash,
        uint256 _txId
    ) public returns (bool)
    {
<span class="cstat-no" title="statement not covered" >        require(expiration &gt; block.timestamp, "Contract expired")</span>;  // solhint-disable-line not-rely-on-time
<span class="cstat-no" title="statement not covered" >        require(msg.sender == reputationOracle, "Address calling not the reputation oracle")</span>;
<span class="cstat-no" title="statement not covered" >        uint256 balance = getBalance()</span>;
<span class="cstat-no" title="statement not covered" >        require(balance &gt; 0, "EIP20 contract out of funds")</span>;
<span class="cstat-no" title="statement not covered" >        require(status != EscrowStatuses.Launched, "Escrow in Launched status state")</span>;
<span class="cstat-no" title="statement not covered" >        require(status != EscrowStatuses.Paid, "Escrow in Paid status state")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        resultsManifestUrl = _url</span>;
<span class="cstat-no" title="statement not covered" >        resultsManifestHash = _hash</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        (uint256 reputationOracleFee, uint256 recordingOracleFee) = finalizePayouts(_amounts)</span>;
<span class="cstat-no" title="statement not covered" >        HMTokenInterface token = HMTokenInterface(eip20)</span>;
        token.transferBulk(_recipients, finalAmounts, _txId);
<span class="cstat-no" title="statement not covered" >        bool success = token.transfer(reputationOracle, reputationOracleFee)</span>;
<span class="cstat-no" title="statement not covered" >        success = token.transfer(recordingOracle, recordingOracleFee)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        balance = getBalance()</span>;
<span class="cstat-no" title="statement not covered" >        if (balance &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >            success = token.transfer(canceler, balance)</span>;
        }
<span class="cstat-no" title="statement not covered" >        if (success) {</span>
<span class="cstat-no" title="statement not covered" >            if (status == EscrowStatuses.Pending) {</span>
<span class="cstat-no" title="statement not covered" >                status = EscrowStatuses.Partial</span>;
            }
<span class="cstat-no" title="statement not covered" >            if (balance == 0 &amp;&amp; status != EscrowStatuses.Paid) {</span>
<span class="cstat-no" title="statement not covered" >                status = EscrowStatuses.Paid</span>;
            }
        }
<span class="cstat-no" title="statement not covered" >        return success;</span>
    }
&nbsp;
    function killContract() internal {
        status = EscrowStatuses.Cancelled;
        selfdestruct(canceler);
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function finalizePayouts(uint256[] _amounts) public returns (uint256, uint256</span>) {
<span class="cstat-no" title="statement not covered" >        uint256 reputationOracleFee = 0</span>;
<span class="cstat-no" title="statement not covered" >        uint256 recordingOracleFee = 0</span>;
<span class="cstat-no" title="statement not covered" >        for (uint256 j; j &lt; _amounts.length; j++) {</span>
<span class="cstat-no" title="statement not covered" >            uint256 singleReputationOracleFee = reputationOracleStake.mul(_amounts[j]).div(100)</span>;
<span class="cstat-no" title="statement not covered" >            uint256 singleRecordingOracleFee = recordingOracleStake.mul(_amounts[j]).div(100)</span>;
<span class="cstat-no" title="statement not covered" >            uint256 amount = _amounts[j].sub(singleReputationOracleFee).sub(singleRecordingOracleFee)</span>;
<span class="cstat-no" title="statement not covered" >            reputationOracleFee = reputationOracleFee.add(singleReputationOracleFee)</span>;
<span class="cstat-no" title="statement not covered" >            recordingOracleFee = recordingOracleFee.add(singleRecordingOracleFee)</span>;
            finalAmounts.push(amount);
        }
<span class="cstat-no" title="statement not covered" >        return (reputationOracleFee, recordingOracleFee);</span>
    }
&nbsp;
    function partialPayout(uint256 _amount, address _recipient) internal returns (bool) {
        HMTokenInterface token = HMTokenInterface(eip20);
        uint256 reputationOracleFee = reputationOracleStake.mul(_amount).div(100);
        uint256 recordingOracleFee = recordingOracleStake.mul(_amount).div(100);
        uint256 amount = _amount.sub(reputationOracleFee).sub(recordingOracleFee);
        token.transfer(reputationOracle, reputationOracleFee);
        token.transfer(recordingOracle, recordingOracleFee);
        token.transfer(_recipient, amount);
        return true;
    }
&nbsp;
    event Pending(string manifest, string hash);
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sat Jan 12 2019 12:09:37 GMT+0200 (Eastern European Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
